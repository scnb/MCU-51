C51 COMPILER V9.01   SEND_BUTTON_MCU                                                       11/22/2016 22:55:11 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE SEND_BUTTON_MCU
OBJECT MODULE PLACED IN .\output\send_button_mcu.obj
COMPILER INVOKED BY: F:\51\C51\BIN\C51.EXE send_button_mcu.c BROWSE DEBUG OBJECTEXTEND OBJECT(.\output\send_button_mcu.o
                    -bj)

line level    source

   1          #include<reg52.h>
   2          
   3          
   4          
   5          /*¼üÅÌ¶ÔÓ¦IO¿ÚÉèÖÃ*/
   6          unsigned char temp;//ÓÃÀ´´æ´¢P2¿ÚµÄ×´Ì¬
   7          static unsigned char value = 5;//ÓÃÀ´¼ÇÂ¼ÊÇÄÄÒ»¸ö¼üÅÌ±»°´ÏÂ,Í¬Ê±Ò²ÊÇÒªÏòµçÄÔ·¢ËÍµÄÊý×Ö
   8          static unsigned char pre_value;
   9          
  10          
  11          /*´¿ÑÓÊ±³ÌÐò*/
  12          void Delay(int i)
  13          {
  14   1              unsigned char j;
  15   1              for(;i>=0;i--)
  16   1              {
  17   2                      for(j = 0;j < 110;j++)
  18   2                      {
  19   3                      }
  20   2              }
  21   1      }
  22          
  23          
  24          
  25          
  26          /*¾ØÕó¼üÅÌÉ¨Ãèº¯Êý*/
  27          void matrix_button_scan_uart_send()
  28          {
  29   1              /*µÚÒ»ÐÐ*/
  30   1              P2 = 0xfe;
  31   1              temp = P2;
  32   1              temp = temp & 0x0f;
  33   1              if(0x0f != temp)
  34   1              {
  35   2                      Delay(10);
  36   2                      temp = P2;
  37   2                      temp = temp & 0x0f;
  38   2                      if(0x0f != temp)
  39   2                      {
  40   3                              temp = P2;
  41   3                              switch(temp)
  42   3                              {
  43   4                                      case 0xee:value = 0;break;
  44   4                                      case 0xde:value = 1;break;
  45   4                                      case 0xbe:value = 2;break;
  46   4                                      case 0x7e:value = 3;break;
  47   4                              }
  48   3                      }
  49   2              }
  50   1              /*µÚ  ¶þ  ÐÐ*/
  51   1              P2 = 0xfd;
  52   1              temp = P2;
  53   1              temp = temp & 0x0f;
  54   1              if(0x0f != temp)
C51 COMPILER V9.01   SEND_BUTTON_MCU                                                       11/22/2016 22:55:11 PAGE 2   

  55   1              {
  56   2                      Delay(10);
  57   2                      temp = P2;
  58   2                      temp = temp & 0x0f;
  59   2                      if(0x0f != temp)
  60   2                      {
  61   3                              temp = P2;
  62   3                              switch(temp)
  63   3                              {
  64   4                                      case 0xed:value = 4;break;
  65   4                                      case 0xdd:value = 5;break;
  66   4                                      case 0xbd:value = 6;break;
  67   4                                      case 0x7d:value = 7;break;
  68   4                              }
  69   3                      }
  70   2              }
  71   1              /*µÚ  Èý  ÐÐ*/
  72   1              P2 = 0xfb;
  73   1              temp = P2;
  74   1              temp = temp & 0x0f;
  75   1              if(0x0f != temp)
  76   1              {
  77   2                      Delay(10);
  78   2                      temp = P2;
  79   2                      temp = temp & 0x0f;
  80   2                      if(0x0f != temp)
  81   2                      {
  82   3                              temp = P2;
  83   3                              switch(temp)
  84   3                              {
  85   4                                      case 0xeb:value = 8;break;
  86   4                                      case 0xdb:value = 9;break;
  87   4                                      case 0xbb:value = 10;break;
  88   4                                      case 0x7b:value = 11;break;
  89   4                              }
  90   3                      }
  91   2              }
  92   1              /*µÚ  ËÄ  ÐÐ*/
  93   1              P2 = 0xf7;
  94   1              temp = P2;
  95   1              temp = temp & 0x0f;
  96   1              if(0x0f != temp)
  97   1              {
  98   2                      Delay(10);
  99   2                      temp = P2;
 100   2                      temp = temp & 0x0f;
 101   2                      if(0x0f != temp)
 102   2                      {
 103   3                              temp = P2;
 104   3                              switch(temp)
 105   3                              {
 106   4                                      case 0xe7:value = 12;break;
 107   4                                      case 0xd7:value = 13;break;
 108   4                                      case 0xb7:value = 14;break;
 109   4                                      case 0x77:value = 15;break;
 110   4                              }
 111   3                      }
 112   2              }
 113   1      }
 114          
 115          
 116          
C51 COMPILER V9.01   SEND_BUTTON_MCU                                                       11/22/2016 22:55:11 PAGE 3   

 117          
 118          /*¶¨Ê±Æ÷³õÊ¼»¯  ÖÐ¶Ï³õÊ¼»¯    ´®¿Ú¿ØÖÆ¼Ä´æÆ÷SCON³õÊ¼»¯*/
 119          void UartInit(void)             //9600bps@11.0592MHz
 120          {
 121   1              PCON &= 0x7F;           //²¨ÌØÂÊ²»±¶ËÙ
 122   1              SCON = 0x50;            //8Î»Êý¾Ý,¿É±ä²¨ÌØÂÊ
 123   1      //      AUXR &= 0xBF;           //¶¨Ê±Æ÷1Ê±ÖÓÎªFosc/12,¼´12T
 124   1      //      TMOD &= 0x0F;           //Çå³ý¶¨Ê±Æ÷1Ä£Ê½Î»
 125   1              TMOD |= 0x20;           //Éè¶¨¶¨Ê±Æ÷1Îª8Î»×Ô¶¯ÖØ×°·½Ê½
 126   1              TL1 = 0xFD;             //Éè¶¨¶¨Ê±³õÖµ
 127   1              TH1 = 0xFD;             //Éè¶¨¶¨Ê±Æ÷ÖØ×°Öµ
 128   1              ET1 = 0;                //½ûÖ¹¶¨Ê±Æ÷1ÖÐ¶Ï
 129   1              TR1 = 1;                //Æô¶¯¶¨Ê±Æ÷1
 130   1              EA = 1;
 131   1              ES = 1;
 132   1      }
 133          
 134          
 135          
 136          void main()
 137          {
 138   1              UartInit();
 139   1              while(1)
 140   1              {
 141   2                      pre_value = value;
 142   2                      while(1)
 143   2                      {
 144   3                              matrix_button_scan_uart_send();
 145   3                              if(pre_value != value)
 146   3                              {
 147   4                                      break;
 148   4                              }
 149   3                      }
 150   2                      if(pre_value != value)//2016/11/21Áè³¿Ò»µã26·Ö£¬ÖÕÓÚ°ÑÕâ¸ö³ÌÐò¸ã¶¨ÁË£¬ÒªÏë°´Ò»´Î°´¼ü£¬·¢ËÍÒ»¸öÊý¾Ý£¬¾Í²»
             -ÄÜÓÃÖÐ¶ÏÀ´·¢ËÍÊý¾Ý£¬¶øÖ»ÄÜÓÃifÅÐ¶Ï£¬valueµÄÖµÊÇ·ñ¸Ä±äÁË£¬Ä¿Ç°²»ÄÜÊ¹ÓÃÖÐ¶ÏµÄÔ­ÒòÎ´Öª
 151   2                      {
 152   3                              SBUF = value;     //×¢Òâ·¢ËÍÊý¾ÝµÄÊ±ºò£¬ÓÃÖÐ¶ÏÊÇ²»ºÏÊÊµÄ£¬ÒòÎªTIÖ»ÓÐÔÚÊý¾ÝÒÑ¾­´æÈëSBUFºó²Å»á±»Ó²¼þÖÃ1£¬¶
             -ø×Ô¼ºÊ¹ÓÃÖÐ¶ÏµÄ»°Ö»ÄÜÓÃÈí¼þÉèÖÃTI=1²ÅÄÜ½øÈëÖÐ¶Ï£¬ÕâÑùÊÇ²»ºÏÊÊµÄ
 153   3                              while(!TI);   //ÔÚ½ÓÊÕÊý¾ÝµÄÊ±ºò£¬Ê¹ÓÃÖÐ¶ÏÊÇË³ÀûºÏÀíµÄ£¬ÒòÎª£¬Íâ²¿Êý¾Ý·¢ËÍ¹ýÀ´£¬±»´æµ½SBUFÖÐºó£¬RI±»ÖÃ1
             -£¬½øÈëÖÐ¶Ï£¬Í¨¹ýÉèÁ¢Êý¾Ý½ÓÊÕ±êÖ¾Î»£¬È»ºóÔÚÆäËûµÄº¯ÊýÖÐÍ¨¹ýÅÐ¶ÏÊý¾Ý½ÓÊÕ±êÖ¾Î»µÄÖµÀ´¾ö¶¨ÊÇ·ñÖ´ÐÐÏàÓ¦µÄ³ÌÐò
 154   3                              TI = 0;
 155   3                      }
 156   2              }
 157   1      }
 158          
 159          /*void interrupt_4() interrupt 4
 160          {
 161                  SBUF = value;
 162                  while(0 == TI);
 163          }
 164          */


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    355    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V9.01   SEND_BUTTON_MCU                                                       11/22/2016 22:55:11 PAGE 4   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
